<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VoicePing Phase 2 E2E Test</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }

        .test-controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .test-controls h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #555;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        button {
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        button:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: #007bff;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-warning {
            background: #ffc107;
            color: #333;
        }

        .panels-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .panel {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .panel-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .role-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .role-admin {
            background: #dc3545;
            color: white;
        }

        .role-dispatch {
            background: #ffc107;
            color: #333;
        }

        .role-general {
            background: #6c757d;
            color: white;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #dc3545;
        }

        .status-dot.connected {
            background: #28a745;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .status-text {
            font-size: 14px;
            color: #666;
        }

        .section {
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: #555;
            margin-bottom: 10px;
        }

        .channel-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
        }

        .channel-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
        }

        .channel-item.joined {
            background: #d4edda;
            border-color: #28a745;
        }

        .channel-name {
            font-size: 13px;
            color: #333;
        }

        .channel-actions {
            display: flex;
            gap: 6px;
        }

        .btn-small {
            padding: 4px 10px;
            font-size: 12px;
        }

        .ptt-button {
            width: 100%;
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .ptt-button.active {
            background: #28a745;
            animation: ptt-active 0.5s infinite alternate;
        }

        @keyframes ptt-active {
            from { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7); }
            to { box-shadow: 0 0 0 10px rgba(40, 167, 69, 0); }
        }

        .log-area {
            height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            font-size: 12px;
            font-family: 'Courier New', monospace;
        }

        .log-entry {
            padding: 4px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        .log-entry.info {
            color: #17a2b8;
        }

        .log-entry.success {
            color: #28a745;
        }

        .log-entry.error {
            color: #dc3545;
        }

        .log-entry.warning {
            color: #ffc107;
        }

        .timestamp {
            color: #6c757d;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 6px;
            color: #555;
        }

        input, select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #007bff;
        }

        .token-display {
            padding: 8px;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            word-break: break-all;
            max-height: 80px;
            overflow-y: auto;
        }

        .dropdown-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .dropdown-group select {
            flex: 1;
        }

        @media (max-width: 1400px) {
            .panels-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <h1>VoicePing Phase 2 E2E Test</h1>

    <div class="test-controls">
        <h2>Test Controls</h2>
        <div class="button-group">
            <button id="seedDataBtn" class="btn-primary">Seed Test Data</button>
            <button id="clearLogsBtn" class="btn-warning">Clear All Logs</button>
        </div>

        <div class="section">
            <div class="section-title">JWT Token Generator</div>
            <div class="form-group">
                <label>User ID</label>
                <input type="text" id="tokenUserId" placeholder="e.g., custom-user-1">
            </div>
            <div class="form-group">
                <label>Role</label>
                <select id="tokenRole">
                    <option value="GENERAL">GENERAL</option>
                    <option value="DISPATCH">DISPATCH</option>
                    <option value="ADMIN">ADMIN</option>
                </select>
            </div>
            <div class="form-group">
                <label>Event ID</label>
                <input type="text" id="tokenEventId" value="test-event-1">
            </div>
            <div class="form-group">
                <label>Channel IDs (comma-separated)</label>
                <input type="text" id="tokenChannelIds" placeholder="e.g., channel-1,channel-2">
            </div>
            <button id="generateTokenBtn" class="btn-success">Generate Token</button>
            <div class="form-group" id="tokenOutput" style="display: none; margin-top: 10px;">
                <label>Generated Token</label>
                <div class="token-display" id="tokenDisplay"></div>
            </div>
        </div>
    </div>

    <div class="panels-container">
        <!-- Admin Panel -->
        <div class="panel">
            <div class="panel-header">
                <div class="panel-title">Admin Panel</div>
                <div class="role-badge role-admin">Admin</div>
            </div>

            <div class="status-indicator">
                <div class="status-dot" id="adminStatusDot"></div>
                <div class="status-text" id="adminStatusText">Disconnected</div>
            </div>

            <div class="section">
                <button id="adminConnectBtn" class="btn-primary" style="width: 100%;">Connect</button>
                <button id="adminDisconnectBtn" class="btn-danger" style="width: 100%; margin-top: 8px;" disabled>Disconnect</button>
            </div>

            <div class="section">
                <div class="section-title">Channels</div>
                <div class="channel-list" id="adminChannels"></div>
            </div>

            <div class="section">
                <button id="adminPttBtn" class="ptt-button btn-success" disabled>Push to Talk</button>
            </div>

            <div class="section">
                <div class="section-title">Admin Actions</div>
                <div class="dropdown-group">
                    <select id="adminForceDisconnectUser">
                        <option value="">Select User...</option>
                    </select>
                    <button id="adminForceDisconnectBtn" class="btn-danger btn-small">Force Disconnect</button>
                </div>
                <div class="dropdown-group">
                    <select id="adminBanUser">
                        <option value="">Select User...</option>
                    </select>
                    <button id="adminBanBtn" class="btn-danger btn-small">Ban</button>
                    <button id="adminUnbanBtn" class="btn-success btn-small">Unban</button>
                </div>
            </div>

            <div class="section">
                <div class="section-title">Log</div>
                <div class="log-area" id="adminLog"></div>
            </div>
        </div>

        <!-- Dispatch Panel -->
        <div class="panel">
            <div class="panel-header">
                <div class="panel-title">Dispatch Panel</div>
                <div class="role-badge role-dispatch">Dispatch</div>
            </div>

            <div class="status-indicator">
                <div class="status-dot" id="dispatchStatusDot"></div>
                <div class="status-text" id="dispatchStatusText">Disconnected</div>
            </div>

            <div class="section">
                <button id="dispatchConnectBtn" class="btn-primary" style="width: 100%;">Connect</button>
                <button id="dispatchDisconnectBtn" class="btn-danger" style="width: 100%; margin-top: 8px;" disabled>Disconnect</button>
            </div>

            <div class="section">
                <div class="section-title">Channels</div>
                <div class="channel-list" id="dispatchChannels"></div>
            </div>

            <div class="section">
                <button id="dispatchPttBtn" class="ptt-button btn-success" disabled>Push to Talk</button>
                <button id="dispatchPriorityPttBtn" class="ptt-button btn-warning" disabled>Priority PTT</button>
                <button id="dispatchEmergencyBtn" class="ptt-button btn-danger" disabled>Emergency Broadcast (Hold 2s)</button>
            </div>

            <div class="section">
                <div class="section-title">Dispatch Actions</div>
                <div class="dropdown-group">
                    <select id="dispatchForceDisconnectUser">
                        <option value="">Select User...</option>
                    </select>
                    <button id="dispatchForceDisconnectBtn" class="btn-danger btn-small">Force Disconnect</button>
                </div>
            </div>

            <div class="section">
                <div class="section-title">Log</div>
                <div class="log-area" id="dispatchLog"></div>
            </div>
        </div>

        <!-- General Panel -->
        <div class="panel">
            <div class="panel-header">
                <div class="panel-title">General Panel</div>
                <div class="role-badge role-general">General</div>
            </div>

            <div class="status-indicator">
                <div class="status-dot" id="generalStatusDot"></div>
                <div class="status-text" id="generalStatusText">Disconnected</div>
            </div>

            <div class="section">
                <button id="generalConnectBtn" class="btn-primary" style="width: 100%;">Connect</button>
                <button id="generalDisconnectBtn" class="btn-danger" style="width: 100%; margin-top: 8px;" disabled>Disconnect</button>
            </div>

            <div class="section">
                <div class="section-title">Channels</div>
                <div class="channel-list" id="generalChannels"></div>
            </div>

            <div class="section">
                <button id="generalPttBtn" class="ptt-button btn-success" disabled>Push to Talk</button>
            </div>

            <div class="section">
                <div class="section-title">Log</div>
                <div class="log-area" id="generalLog"></div>
            </div>
        </div>
    </div>

    <script type="module" src="/test/phase2.js"></script>
</body>
</html>
