---
phase: 04-dispatch-multi-channel-monitoring
plan: 03
type: execute
wave: 3
depends_on: ["04-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "TypeScript and web-ui builds pass"
    - "Docker container starts and serves the application"
    - "Dispatch monitoring page loads and displays channel grid"
    - "Mute/unmute toggles work visually"
    - "PTT works on compact channel cards"
    - "Activity indicators appear when channels have active speakers"
  artifacts: []
  key_links: []
---

<objective>
Build verification and visual/functional verification checkpoint for Phase 4 dispatch multi-channel monitoring.

Purpose: Ensure the complete dispatch monitoring feature works end-to-end -- TypeScript compiles, web-ui builds, Docker starts, and the monitoring page is visually correct and functionally working.

Output: Verified working dispatch monitoring feature ready for production.
</objective>

<execution_context>
@C:\Users\jotha\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\jotha\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-dispatch-multi-channel-monitoring/04-01-SUMMARY.md
@.planning/phases/04-dispatch-multi-channel-monitoring/04-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build verification and integration fixes</name>
  <files></files>
  <action>
1. Run `npx tsc --noEmit` from project root. Fix any TypeScript compilation errors.

2. Run `npm run build` from `web-ui/` directory. Fix any build errors (missing imports, syntax issues, JSX issues).

3. If Docker is available, run `docker compose build` and `docker compose up -d` to verify the full stack starts. Check logs with `docker compose logs --tail=50` for errors.

4. If there are any import errors, missing exports, or wiring issues discovered during the build:
   - Fix them directly
   - Document what was fixed and why

5. Verify key file existence and content:
   - `src/server/config.ts` contains `dispatchSimultaneousChannelLimit`
   - `src/server/signaling/handlers.ts` checks DISPATCH role for channel limit
   - `web-ui/src/components/ChannelCard.jsx` has compact variant
   - `web-ui/src/components/ChannelGrid.jsx` exists
   - `web-ui/src/pages/DispatchMonitoring.jsx` exists
   - `web-ui/src/App.jsx` has `/event/:eventId/monitoring` route
   - `web-ui/src/styles.css` has `.dispatch-monitoring` and `.channel-grid` styles

6. If any integration issues are found between the components (e.g., prop mismatches, missing context providers, incorrect imports), fix them.
  </action>
  <verify>
`npx tsc --noEmit` exits with code 0.
`npm run build` in web-ui/ exits with code 0.
Docker build succeeds (if available).
All key files exist and contain expected content.
  </verify>
  <done>
TypeScript and web-ui builds pass.
All integration issues resolved.
Application is buildable and deployable.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete dispatch multi-channel monitoring feature:
- Server-side DISPATCH role can join up to 50 channels (bypasses 10-channel limit)
- DispatchMonitoring page at `/event/:eventId/monitoring` with responsive channel grid
- Compact ChannelCards with mute toggles, activity indicators, and PTT buttons
- Mute All / Unmute All bulk actions
- Navigation links from Events page and Dispatch console
- Real-time permission updates for dynamic channel list changes
  </what-built>
  <how-to-verify>
1. Start the application (Docker or dev server)
2. Log in as a DISPATCH user
3. Navigate to Events page and verify "Multi-Channel Monitor" link appears
4. Click "Multi-Channel Monitor" to open the monitoring page
5. Verify the page shows:
   - Header with "Multi-Channel Monitor" title
   - Mute All / Unmute All buttons
   - Stats bar (monitoring count, muted, active)
   - Grid of compact channel cards
6. On each channel card, verify:
   - Channel name displayed
   - Connection status pill
   - Mute toggle button (speaker icon)
   - PTT button
7. Click mute toggle on a channel -- verify it shows muted state (dimmed, muted icon)
8. Click "Mute All" -- verify all channels show muted state
9. Click "Unmute All" -- verify all channels return to normal state
10. If two browser tabs open: have one user PTT on a channel, verify the monitoring page shows activity indicator (pulsing dot + speaker name) on that channel
11. Test PTT on a compact card: hold the PTT button, verify it shows transmitting state
12. Navigate to the Dispatch console and verify "Monitor Channels" link appears
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
- Both builds pass (TypeScript + web-ui)
- Application starts successfully
- Dispatch monitoring page loads and functions correctly
- Human verification confirms visual and functional correctness
</verification>

<success_criteria>
1. All builds pass
2. Dispatch monitoring page loads at `/event/:eventId/monitoring`
3. Channel grid displays compact cards with mute toggles and activity indicators
4. PTT works on compact cards
5. Human confirms the feature is visually and functionally correct
</success_criteria>

<output>
After completion, create `.planning/phases/04-dispatch-multi-channel-monitoring/04-03-SUMMARY.md`
</output>
