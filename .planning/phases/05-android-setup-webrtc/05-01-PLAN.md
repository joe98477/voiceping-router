---
phase: 05-android-setup-webrtc
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - android/settings.gradle.kts
  - android/build.gradle.kts
  - android/app/build.gradle.kts
  - android/app/proguard-rules.pro
  - android/gradle.properties
  - android/app/src/main/AndroidManifest.xml
  - android/app/src/main/java/com/voiceping/android/VoicePingApplication.kt
  - android/app/src/main/java/com/voiceping/android/presentation/MainActivity.kt
  - android/app/src/main/java/com/voiceping/android/presentation/navigation/NavGraph.kt
  - android/app/src/main/java/com/voiceping/android/presentation/theme/Color.kt
  - android/app/src/main/java/com/voiceping/android/presentation/theme/Theme.kt
  - android/app/src/main/java/com/voiceping/android/presentation/theme/Type.kt
  - android/app/src/main/java/com/voiceping/android/domain/model/User.kt
  - android/app/src/main/java/com/voiceping/android/domain/model/Event.kt
  - android/app/src/main/java/com/voiceping/android/domain/model/Channel.kt
  - android/app/src/main/java/com/voiceping/android/domain/model/Team.kt
  - android/app/src/main/java/com/voiceping/android/domain/model/ConnectionState.kt
  - android/app/src/main/java/com/voiceping/android/di/AppModule.kt
  - android/app/src/main/res/values/strings.xml
  - android/app/src/main/res/values/themes.xml
  - android/app/src/main/res/drawable/ic_logo.xml
autonomous: true

must_haves:
  truths:
    - "Android project builds successfully with Kotlin 2.3.10 and AGP 9.0"
    - "App launches on API 26+ emulator showing dark themed shell"
    - "Hilt dependency injection is configured and working"
    - "Material 3 dark theme renders consistently across all placeholder screens"
  artifacts:
    - path: "android/app/build.gradle.kts"
      provides: "Android build configuration with all Phase 5 dependencies"
      contains: "libmediasoup-android"
    - path: "android/app/src/main/java/com/voiceping/android/VoicePingApplication.kt"
      provides: "Hilt application entry point"
      contains: "@HiltAndroidApp"
    - path: "android/app/src/main/java/com/voiceping/android/presentation/theme/Theme.kt"
      provides: "Material 3 dark-only theme"
      contains: "darkColorScheme"
    - path: "android/app/src/main/java/com/voiceping/android/domain/model/Channel.kt"
      provides: "Channel domain model"
    - path: "android/app/src/main/java/com/voiceping/android/presentation/navigation/NavGraph.kt"
      provides: "Compose Navigation graph with route definitions"
  key_links:
    - from: "android/app/src/main/java/com/voiceping/android/presentation/MainActivity.kt"
      to: "NavGraph.kt"
      via: "Compose setContent with NavHost"
      pattern: "NavGraph|NavHost"
    - from: "android/app/build.gradle.kts"
      to: "VoicePingApplication.kt"
      via: "Hilt plugin enables @HiltAndroidApp"
      pattern: "hilt.android"
---

<objective>
Create the Android project from scratch in the `android/` subdirectory. Set up Gradle build files with all Phase 5 dependencies (Kotlin 2.3.10, Compose 1.10, Material 3, OkHttp, Retrofit, Hilt, mediasoup-android, WebRTC, EncryptedSharedPreferences). Configure Hilt DI, define Material 3 dark-only theme with cyan accent, create domain models, and wire up the app shell (MainActivity + NavGraph with placeholder routes).

Purpose: Establish the project foundation that all subsequent plans build upon.
Output: Compilable Android project with dark themed app shell showing placeholder screens.
</objective>

<execution_context>
@C:\Users\jotha\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\jotha\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-android-setup-webrtc/05-RESEARCH.md

Reference the research file extensively — it contains verified dependency versions, build configuration, project structure, ProGuard rules, and theme color definitions.

IMPORTANT: This is a NEW Android project in the `android/` subdirectory of the existing repo. Do NOT modify any existing server-side code.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Android project structure and Gradle build files</name>
  <files>
    android/settings.gradle.kts
    android/build.gradle.kts
    android/app/build.gradle.kts
    android/app/proguard-rules.pro
    android/gradle.properties
    android/app/src/main/AndroidManifest.xml
  </files>
  <action>
    Create the Android project directory structure under `android/` at the repo root.

    **settings.gradle.kts:** Configure project name "VoicePing", include `:app` module, add repositories (google, mavenCentral).

    **build.gradle.kts (project-level):** Apply AGP 9.0.0, Kotlin 2.3.10, Hilt 2.51.1 plugins with `apply false`.

    **app/build.gradle.kts:** Full module build config per research:
    - Plugins: com.android.application, org.jetbrains.kotlin.android, com.google.dagger.hilt.android, kotlin-kapt
    - namespace: com.voiceping.android
    - compileSdk: 35, minSdk: 26, targetSdk: 35
    - Java 17 compatibility
    - Compose enabled with kotlinCompilerExtensionVersion matching Kotlin 2.3.10
    - ALL dependencies from research Standard Stack section:
      - Core: core-ktx 1.15.0, lifecycle-runtime-ktx 2.8.7, lifecycle-viewmodel-compose 2.8.7
      - Compose BOM 2026.01.00, material3, activity-compose 1.9.3, navigation-compose 2.8.5
      - Hilt: hilt-android 2.51.1, hilt-compiler 2.51.1, hilt-navigation-compose 1.2.0
      - Networking: okhttp 4.12.0, logging-interceptor 4.12.0, retrofit 2.11.0, converter-gson 2.11.0, gson 2.11.0
      - WebRTC: stream-webrtc-android 1.3.9
      - mediasoup: libmediasoup-android 0.7.0 (io.github.crow-misia.libmediasoup-android)
      - Security: security-crypto 1.1.0-alpha06
      - Coroutines: kotlinx-coroutines-android 1.10.1

    **proguard-rules.pro:** Keep rules for mediasoup JNI classes (org.mediasoup.**), WebRTC classes (org.webrtc.**), Gson models (com.voiceping.android.data.model.**), and Signature/Annotation attributes.

    **gradle.properties:** Set android.useAndroidX=true, kotlin.code.style=official, org.gradle.jvmargs=-Xmx2048m.

    **AndroidManifest.xml:** Declare application (name=".VoicePingApplication"), INTERNET permission, single activity (MainActivity) with LAUNCHER intent filter. Set theme to @style/Theme.VoicePing.

    Also create a Gradle wrapper by running `gradle wrapper --gradle-version 8.12` (or include gradle-wrapper.properties manually with distributionUrl pointing to gradle-8.12-bin.zip). If Gradle CLI is not available, create the wrapper properties file manually.
  </action>
  <verify>
    Navigate to `android/` directory and run `./gradlew assembleDebug` (or `gradlew.bat assembleDebug` on Windows). Build should succeed or at minimum resolve all dependencies. If Gradle wrapper is not available, verify that build.gradle.kts files are syntactically valid by checking with an IDE or manual review.
  </verify>
  <done>
    Android project exists at `android/` with all dependencies declared, ProGuard rules configured, and Gradle build files syntactically valid. The project structure matches the research file's recommended layout.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Hilt setup, domain models, Material 3 dark theme, and app shell</name>
  <files>
    android/app/src/main/java/com/voiceping/android/VoicePingApplication.kt
    android/app/src/main/java/com/voiceping/android/presentation/MainActivity.kt
    android/app/src/main/java/com/voiceping/android/presentation/navigation/NavGraph.kt
    android/app/src/main/java/com/voiceping/android/presentation/theme/Color.kt
    android/app/src/main/java/com/voiceping/android/presentation/theme/Theme.kt
    android/app/src/main/java/com/voiceping/android/presentation/theme/Type.kt
    android/app/src/main/java/com/voiceping/android/domain/model/User.kt
    android/app/src/main/java/com/voiceping/android/domain/model/Event.kt
    android/app/src/main/java/com/voiceping/android/domain/model/Channel.kt
    android/app/src/main/java/com/voiceping/android/domain/model/Team.kt
    android/app/src/main/java/com/voiceping/android/domain/model/ConnectionState.kt
    android/app/src/main/java/com/voiceping/android/di/AppModule.kt
    android/app/src/main/res/values/strings.xml
    android/app/src/main/res/values/themes.xml
    android/app/src/main/res/drawable/ic_logo.xml
  </files>
  <action>
    **VoicePingApplication.kt:** Hilt application class with @HiltAndroidApp annotation.

    **Domain models (data classes):**
    - `User.kt`: id (String), name (String), email (String)
    - `Event.kt`: id (String), name (String), description (String? = null)
    - `Team.kt`: id (String), name (String), eventId (String)
    - `Channel.kt`: id (String), name (String), teamId (String), teamName (String), currentSpeaker (User? = null), userCount (Int = 0)
    - `ConnectionState.kt`: enum with DISCONNECTED, CONNECTING, CONNECTED, FAILED

    **Theme (Material 3 dark-only):**
    - `Color.kt`: DarkBackground=#121212, DarkSurface=#1E1E1E, DarkSurfaceVariant=#2C2C2C, DarkPrimary=#00BCD4 (cyan accent), DarkOnPrimary=#000000, DarkSecondary=#03DAC6, DarkError=#CF6679, DarkOnSurface=#E0E0E0, DarkOnSurfaceVariant=#A0A0A0
    - `Theme.kt`: VoicePingTheme composable using darkColorScheme() with the above colors. No light theme. Apply to all content.
    - `Type.kt`: Default Material 3 typography (no custom fonts needed).

    **NavGraph.kt:** Compose Navigation with NavHost. Define route constants:
    - "login" — LoginScreen (placeholder Text composable for now)
    - "loading" — LoadingScreen (placeholder)
    - "events" — EventPickerScreen (placeholder)
    - "channels" — ChannelListScreen (placeholder)
    Start destination: "login" (will be updated with auto-login logic in Plan 02)

    **MainActivity.kt:** @AndroidEntryPoint annotated single Activity. In setContent: wrap NavGraph in VoicePingTheme. Enable edge-to-edge display.

    **di/AppModule.kt:** Hilt @Module with @InstallIn(SingletonComponent::class). Provide Gson instance as singleton (used across app for JSON parsing). Provide OkHttpClient as singleton with logging interceptor (debug builds only).

    **Resources:**
    - `strings.xml`: app_name="VoicePing", login/event/channel related strings
    - `themes.xml`: Theme.VoicePing parent Theme.Material3.DayNight.NoActionBar (for system bars)
    - `ic_logo.xml`: Simple vector drawable placeholder — a radio/walkie-talkie icon shape using path data (or a simple circle with "VP" text). Use cyan accent color (#00BCD4).
  </action>
  <verify>
    All Kotlin files compile without errors. VoicePingApplication has @HiltAndroidApp. MainActivity has @AndroidEntryPoint. NavGraph has 4 routes defined. Theme uses darkColorScheme. Domain models are data classes with correct fields.
  </verify>
  <done>
    App launches showing dark themed placeholder screen at login route. Hilt DI is configured. Domain models, theme, and navigation are ready for subsequent plans to implement real screens.
  </done>
</task>

</tasks>

<verification>
1. `android/` directory exists with proper project structure
2. `gradlew assembleDebug` builds successfully (or all Gradle files are syntactically valid if Gradle wrapper unavailable)
3. All domain models are data classes with appropriate fields
4. VoicePingTheme uses dark-only Material 3 color scheme with cyan accent
5. NavGraph defines login, loading, events, channels routes
6. MainActivity is annotated with @AndroidEntryPoint and wraps content in VoicePingTheme
7. Hilt AppModule provides Gson and OkHttpClient singletons
</verification>

<success_criteria>
- Android project compiles with all Phase 5 dependencies
- Dark themed app shell launches with placeholder navigation
- Foundation ready for auth (Plan 02) and networking (Plan 03) implementation
</success_criteria>

<output>
After completion, create `.planning/phases/05-android-setup-webrtc/05-01-SUMMARY.md`
</output>
